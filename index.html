<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Class Schedule Template</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
    h2 { text-align: center; margin-bottom: 5px; color: #1565c0; }
    .header, .major-selector, .theme-selector { text-align: center; margin-bottom: 10px; }
    .layout { display: flex; flex-wrap: wrap; gap: 20px; align-items: flex-start; justify-content: center; }
    .subjects-list {
      background: #fff; border: 1px solid #ccc; border-radius: 8px; padding: 10px; min-width: 240px; margin-bottom: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06); height: 500px; overflow-y: auto;
    }
    .subjects-list h4 { margin-top: 0; margin-bottom: 10px; font-size: 1.1em; color: #1976d2; text-align: center; }
    .subject-item {
      border: 1px solid #aaa; border-radius: 4px; padding: 6px 8px; margin-bottom: 7px;
      background: #eafaf1; cursor: grab; font-size: 0.98em; transition: background 0.2s; user-select: none; display: block; word-break: break-word;
    }
    .subject-item:active { background: #c0e6d0; }
    .subject-item.english { background: #e3f0fa; border-color: #1976d2; }
    .subject-item.filipino { background: #eafaf1; border-color: #6CB288; }
    .subject-item.custom { background: #fffbe6; border-color: #888800; }
    .add-custom-form { text-align: center; margin-bottom: 10px; }
    .add-custom-form input[type="text"] { width: 120px; margin-right: 3px; margin-bottom: 5px; padding: 3px 6px; border-radius: 4px; border: 1px solid #aaa; font-size: 0.97em; }
    .add-custom-form button { background: #1976d2; color: #fff; border: none; padding: 5px 10px; border-radius: 4px; font-size: 0.97em; cursor: pointer; }
    .add-custom-form button:hover { background: #1565c0; }
    table {
      width: 100%; border-collapse: collapse; margin-top: 15px; background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.06);
      transition: background 0.3s, box-shadow 0.3s; min-width: 700px; max-width: 950px;
    }
    th, td { border: 1px solid #444; padding: 8px; text-align: center; vertical-align: top; transition: background 0.3s, color 0.3s; min-width: 100px; position: relative; }
    th { background: #1976d2; color: #fff; }
    tbody tr:nth-child(even) { background: #f1f8ff; }
    .schedule-input { width: 100%; min-height: 40px; border: none; text-align: center; padding: 4px 2px; border-radius: 5px; background: transparent; transition: background 0.2s; font-size: 0.98em; resize: vertical; overflow-y: auto; }
    .schedule-input:focus { outline: none; background-color: #e0f7fa; }
    .btn-group { text-align: center; margin: 20px 0; }
    button { background: #1976d2; color: #fff; border: none; padding: 9px 18px; border-radius: 4px; margin: 0 8px; cursor: pointer; font-size: 1em; }
    button:hover { background: #1565c0; }
    @media print {
      body { background: #fff; padding: 0; }
      .btn-group, .header input, .major-selector, .theme-selector, .subjects-list { display: none !important; }
      table { box-shadow: none; font-size: 13px; }
      th, td { border-color: #000; }
      .schedule-input { border: none !important; background: transparent !important; color: #000 !important; }
    }
    .matcha th { background: #6CB288 !important; color: #fff !important; }
    .matcha tbody tr:nth-child(even) { background: #eafaf1 !important; }
    .matcha table, .matcha td, .matcha th { border-color: #6CB288 !important; }
    .pink th { background: #E75480 !important; color: #fff !important; }
    .pink tbody tr:nth-child(even) { background: #ffe2ed !important; }
    .pink table, .pink td, .pink th { border-color: #E75480 !important; }
    .blue th { background: #1976d2 !important; color: #fff !important; }
    .blue tbody tr:nth-child(even) { background: #e3f0fa !important; }
    .blue table, .blue td, .blue th { border-color: #1976d2 !important; }
    .default th { background: #1976d2 !important; color: #fff !important; }
    .default tbody tr:nth-child(even) { background: #f1f8ff !important; }
    .default table, .default td, .default th { border-color: #444 !important; }
    .droppable { outline: 2px dashed #6CB288 !important; background: #f7fff9 !important; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body class="default">

  <div class="major-selector">
    <label for="major">Major: </label>
    <select id="major" onchange="changeMajor()">
      <option value="Filipino">Filipino</option>
      <option value="English">English</option>
    </select>
  </div>

  <h2 id="majorTitle">BACHELOR OF SECONDARY EDUCATION – FILIPINO</h2>
  <div class="header">
    <strong>1st Semester, Academic Year 2025–2026</strong><br>
    Section: <input type="text" id="sectionName" placeholder="Enter Section" style="width: 200px;">
  </div>
  <div class="theme-selector">
    <label for="theme">Table Color: </label>
    <select id="theme" onchange="changeTheme()">
      <option value="default">Default</option>
      <option value="matcha">Matcha Green</option>
      <option value="pink">Pink</option>
      <option value="blue">Blue</option>
    </select>
  </div>

  <div class="layout">
    <div class="subjects-list" id="subjectsList">
      <h4>Drag Subject to Schedule</h4>
      <form class="add-custom-form" onsubmit="return addCustomSubject();">
        <input type="text" id="customSubject" placeholder="Subject name" required>
        <input type="text" id="customRoom" placeholder="Room/Time (optional)">
        <button type="submit">Add Custom Subject</button>
      </form>
      <!-- Filipino subjects -->
      <div class="subject-item filipino" draggable="true" data-value="GECC 101a – Art Appreciation&#10;Rm. 200 (CE)">GECC 101a – Art Appreciation<br><small>Rm. 200 (CE)</small></div>
      <div class="subject-item filipino" draggable="true" data-value="EDUC 101 – Child & Adolescent Learner&#10;Rm. 202 (CE)">EDUC 101 – Child & Adolescent Learner<br><small>Rm. 202 (CE)</small></div>
      <div class="subject-item filipino" draggable="true" data-value="GECC 105a – Science, Tech & Society&#10;Rm. 200 (CE)">GECC 105a – Science, Tech & Society<br><small>Rm. 200 (CE)</small></div>
      <div class="subject-item filipino" draggable="true" data-value="GECC 104a – Ethics&#10;Rm. 202 (CE)">GECC 104a – Ethics<br><small>Rm. 202 (CE)</small></div>
      <div class="subject-item filipino" draggable="true" data-value="GECC 103a – Math in the Modern World&#10;LHS 210 (CE)">GECC 103a – Math in the Modern World<br><small>LHS 210 (CE)</small></div>
      <div class="subject-item filipino" draggable="true" data-value="GECC 102a – Purposive Comm&#10;LHS 210 (CE)">GECC 102a – Purposive Comm<br><small>LHS 210 (CE)</small></div>
      <div class="subject-item filipino" draggable="true" data-value="GEEC 111 – Gender & Society&#10;LHS 210 (CE)">GEEC 111 – Gender & Society<br><small>LHS 210 (CE)</small></div>
      <div class="subject-item filipino" draggable="true" data-value="PATHFIT 101 – Mvmt. Competency Trng&#10;2:30–4:30PM&#10;Grnd-13 (CE)">PATHFIT 101 – Mvmt. Competency Trng<br><small>2:30–4:30PM, Grnd-13 (CE)</small></div>
      <div class="subject-item filipino" draggable="true" data-value="NSTP 101C – LTS&#10;8:00–11:00AM&#10;Grnd-13 (CE)">NSTP 101C – LTS<br><small>8:00–11:00AM, Grnd-13 (CE)</small></div>
      <!-- English major schedule slots -->
      <div class="subject-item english" draggable="true" data-value="08:00–09:30 AM&#10;Room 202 – BTVTED/BTLED (CE)" style="display:none;">08:00–09:30 AM<br><small>Room 202 – BTVTED/BTLED (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="10:00 AM–12:00 PM&#10;Room 200 – BTVTED/BTLED (CE)" style="display:none;">10:00 AM–12:00 PM<br><small>Room 200 – BTVTED/BTLED (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="01:00–02:00 PM&#10;Room 211 – Lecture Room (CE)" style="display:none;">01:00–02:00 PM<br><small>Room 211 – Lecture Room (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="08:00–09:30 AM&#10;LHS 210 – Lecture Room (CE)" style="display:none;">08:00–09:30 AM<br><small>LHS 210 – Lecture Room (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="09:30–11:00 AM&#10;Room 202 – BTVTED/BTLED (CE)" style="display:none;">09:30–11:00 AM<br><small>Room 202 – BTVTED/BTLED (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="02:00–03:30 PM&#10;Room 205 – Classroom (CE)" style="display:none;">02:00–03:30 PM<br><small>Room 205 – Classroom (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="08:00–10:00 AM&#10;LHS 210 – Lecture Room (CE)" style="display:none;">08:00–10:00 AM<br><small>LHS 210 – Lecture Room (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="12:00–02:00 PM&#10;Room 200 – BTVTED/BTLED (CE)" style="display:none;">12:00–02:00 PM<br><small>Room 200 – BTVTED/BTLED (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="10:00 AM–12:00 PM&#10;Grnd - 15 (CE)" style="display:none;">10:00 AM–12:00 PM<br><small>Grnd - 15 (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="08:00–09:30 AM&#10;Room 202 – BTVTED/BTLED (CE)" style="display:none;">08:00–09:30 AM<br><small>Room 202 – BTVTED/BTLED (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="09:30–11:00 AM&#10;Room 202 – BTVTED/BTLED (CE)" style="display:none;">09:30–11:00 AM<br><small>Room 202 – BTVTED/BTLED (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="12:00–01:00 PM&#10;Room 207 – BSEd (CE)" style="display:none;">12:00–01:00 PM<br><small>Room 207 – BSEd (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="01:00–02:00 PM&#10;LHS 210 – Lecture Room (CE)" style="display:none;">01:00–02:00 PM<br><small>LHS 210 – Lecture Room (CE)</small></div>
      <div class="subject-item english" draggable="true" data-value="08:00–11:00 AM&#10;Grnd - 11 (CE)" style="display:none;">08:00–11:00 AM<br><small>Grnd - 11 (CE)</small></div>
    </div>
    <div style="flex: 1 1 700px;">
      <div class="btn-group">
        <button onclick="saveSchedule()">Save Schedule</button>
        <button onclick="window.print()">Print Schedule</button>
        <button onclick="saveAsImage()">Save as Image</button>
        <button onclick="resetSchedule()" style="background:#E75480;">Reset</button>
      </div>
      <table id="scheduleTable">
        <thead>
          <tr>
            <th>TIME</th>
            <th>MONDAY</th>
            <th>TUESDAY</th>
            <th>WEDNESDAY</th>
            <th>THURSDAY</th>
            <th>FRIDAY</th>
            <th>SATURDAY</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>7:30–8:00</td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
          </tr>
          <tr>
            <td>8:00–9:00</td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
          </tr>
          <tr>
            <td>9:00–10:00</td>
            <td><textarea class="schedule-input">GECC 101a – Art Appreciation&#10;Rm. 200 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input">GECC 101a – Art Appreciation&#10;Rm. 200 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input">GECC 101a – Art Appreciation&#10;Rm. 200 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
          </tr>
          <tr>
            <td>10:00–11:00</td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
          </tr>
          <tr>
            <td>11:00–12:00</td>
            <td><textarea class="schedule-input">EDUC 101 – Child & Adolescent Learner&#10;Rm. 202 (CE)</textarea></td>
            <td><textarea class="schedule-input">GEEC 111 – Gender & Society&#10;LHS 210 (CE)</textarea></td>
            <td><textarea class="schedule-input">EDUC 101 – Child & Adolescent Learner&#10;Rm. 202 (CE)</textarea></td>
            <td><textarea class="schedule-input">GEEC 111 – Gender & Society&#10;LHS 210 (CE)</textarea></td>
            <td><textarea class="schedule-input">EDUC 101 – Child & Adolescent Learner&#10;Rm. 202 (CE)</textarea></td>
            <td><textarea class="schedule-input">NSTP 101C – LTS&#10;8:00–11:00AM&#10;Grnd-13 (CE)</textarea></td>
          </tr>
          <tr>
            <td>12:00–1:00</td>
            <td><textarea class="schedule-input">GECC 105a – Science, Tech & Society&#10;Rm. 200 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input">GECC 105a – Science, Tech & Society&#10;Rm. 200 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
          </tr>
          <tr>
            <td>1:00–2:00</td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input">GECC 104a – Ethics&#10;Rm. 202 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input">GECC 104a – Ethics&#10;Rm. 202 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
          </tr>
          <tr>
            <td>2:00–3:00</td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input">GECC 105a – Science, Tech & Society&#10;Rm. 207 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input">GECC 103a – Math in the Modern World&#10;LHS 210 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
          </tr>
          <tr>
            <td>3:00–4:00</td>
            <td><textarea class="schedule-input">PATHFIT 101 – Mvmt. Competency Trng&#10;2:30–4:30PM&#10;Grnd-13 (CE)</textarea></td>
            <td><textarea class="schedule-input">GECC 102a – Purposive Comm&#10;LHS 210 (CE)</textarea></td>
            <td><textarea class="schedule-input">GECC 103a – Math in the Modern World&#10;LHS 210 (CE)</textarea></td>
            <td><textarea class="schedule-input">GECC 102a – Purposive Comm&#10;LHS 210 (CE)</textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
          </tr>
          <tr>
            <td>4:00–5:00</td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
            <td><textarea class="schedule-input"></textarea></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <script>
    // Drag-and-drop logic for subject list to schedule cells
    let draggedValue = null;
    function updateDraggables() {
      document.querySelectorAll('.subject-item').forEach(item => {
        item.addEventListener('dragstart', function(e) {
          draggedValue = this.getAttribute('data-value');
        });
      });
    }
    function enableDroppable() {
      document.querySelectorAll('.schedule-input').forEach(cell => {
        cell.addEventListener('dragover', function(e) {
          e.preventDefault();
          this.parentElement.classList.add('droppable');
        });
        cell.addEventListener('dragleave', function(e) {
          this.parentElement.classList.remove('droppable');
        });
        cell.addEventListener('drop', function(e) {
          e.preventDefault();
          if (draggedValue) {
            this.value = draggedValue.replace(/&#10;/g, '\n');
          }
          this.parentElement.classList.remove('droppable');
        });
      });
    }
    // Initial enable
    updateDraggables();
    enableDroppable();
    // Add Custom Subject
    function addCustomSubject() {
      const name = document.getElementById('customSubject').value.trim();
      const room = document.getElementById('customRoom').value.trim();
      if (!name) return false;
      let display = name;
      let value = name;
      if (room) {
        display += "<br><small>" + room + "</small>";
        value += "&#10;" + room;
      }
      // Make div
      const div = document.createElement('div');
      div.className = 'subject-item custom';
      div.setAttribute('draggable', 'true');
      div.setAttribute('data-value', value);
      div.innerHTML = display;
      // Drag event
      div.addEventListener('dragstart', function(e) {
        draggedValue = this.getAttribute('data-value');
      });
      // Add to subject list
      document.getElementById('subjectsList').appendChild(div);
      // Reset form
      document.getElementById('customSubject').value = "";
      document.getElementById('customRoom').value = "";
      return false;
    }
    // Theme logic
    function changeTheme() {
      const theme = document.getElementById('theme').value;
      document.body.className = theme;
    }
    // Major logic
    function changeMajor() {
      const major = document.getElementById('major').value;
      const majorTitle = document.getElementById('majorTitle');
      majorTitle.textContent = "BACHELOR OF SECONDARY EDUCATION – " + major.toUpperCase();
      // Show/hide subject items based on major
      document.querySelectorAll('.subject-item.filipino').forEach(item => {
        item.style.display = (major === "Filipino") ? "" : "none";
      });
      document.querySelectorAll('.subject-item.english').forEach(item => {
        item.style.display = (major === "English") ? "" : "none";
      });
    }
    function saveSchedule() {
      let table = document.getElementById('scheduleTable');
      let section = document.getElementById('sectionName').value;
      let csv = 'Section:,' + section + '\n';
      for (let row of table.rows) {
        let rowData = [];
        for (let i = 0; i < row.cells.length; i++) {
          if (i === 0) { rowData.push(row.cells[i].textContent); }
          else {
            let input = row.cells[i].querySelector('.schedule-input');
            rowData.push(input ? input.value.replace(/,/g, ' ') : '');
          }
        }
        csv += rowData.join(',') + '\n';
      }
      let blob = new 
